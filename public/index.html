<script>
const socket = io();
const form = document.getElementById('form');
const input = document.getElementById('input');
const pseudoInput = document.getElementById('pseudo');
const messages = document.getElementById('messages');

// Couleurs uniques pour chaque pseudo
const colors = {};
function getColor(pseudo) {
  if (!colors[pseudo]) {
    colors[pseudo] = '#' + Math.floor(Math.random()*16777215).toString(16);
  }
  return colors[pseudo];
}

form.addEventListener('submit', (e) => {
  e.preventDefault();
  if (input.value && pseudoInput.value) {
    socket.emit('chat message', { pseudo: pseudoInput.value, message: input.value });
    input.value = '';
  }
});

socket.on('chat message', ({ pseudo, message }) => {
  const item = document.createElement('div');
  item.classList.add('message');

  // VÃ©rifie si c'est ton message
  if (pseudo === pseudoInput.value) {
    item.classList.add('mine');
  } else {
    item.classList.add('other');
  }

  item.innerHTML = `<span class="pseudo" style="color:${getColor(pseudo)}">${pseudo}</span>: ${message}`;
  messages.appendChild(item);
  messages.scrollTop = messages.scrollHeight;
});
</script>

